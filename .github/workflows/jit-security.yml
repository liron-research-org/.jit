name: Workflows generated by the MVS plan
run-name: ${{ fromJSON(github.event.inputs.client_payload).payload.job_title }}

on:
  workflow_dispatch:
    inputs:
      client_payload:
        description: The Client payload
        required: true

permissions:
  contents: read
  id-token: write

jobs:
  jit-ci-job:
    runs-on: ubuntu-22.04
    timeout-minutes: ${{ fromJSON(github.event.inputs.client_payload).payload.runner_setup.timeout_minutes }}
    steps:
      # 1) Add Harden-Runner step to monitor outbound calls
      - name: StepSecurity Harden-Runner (Audit all outbound calls)
        uses: step-security/harden-runner@v2.10.0
        with:
          egress-policy: audit

      # 2) Your existing step
      - name: ${{ fromJSON(inputs.client_payload).payload.workflow_job_name }}
        uses: jitsecurity-controls/jit-github-action@main
